"use strict";(self.webpackChunkimc2025=self.webpackChunkimc2025||[]).push([[4592],{
/***/2199:
/***/(e,a,t)=>{
/* harmony export */t.d(a,{
/* harmony export */V:()=>/* binding */l
/* harmony export */});
/* harmony import */var r=t(6540),s=t(7767);
/* harmony import */const l=e=>{const a=(0,s/* .useNavigate */.Zp)(),t=(0,s/* .useLocation */.zy)();(0,r.useEffect)((()=>{const a=a=>{e&&(a.preventDefault(),a.returnValue="You have unsaved changes. Do you really want to leave?")};return window.addEventListener("beforeunload",a),()=>{window.removeEventListener("beforeunload",a)}}),[e]),(0,r.useEffect)((()=>{const r=r=>{if(e){window.confirm("You have unsaved changes. Do you really want to leave?")||(r.preventDefault(),a(t.pathname,{replace:!0}))}};return window.addEventListener("popstate",r),()=>{window.removeEventListener("popstate",r)}}),[e,a,t.pathname])};
/***/},
/***/8495:
/***/(e,a,t)=>{t.r(a),
/* harmony export */t.d(a,{
/* harmony export */default:()=>j
/* harmony export */});
/* harmony import */var r=t(9156),s=t(5680),l=t(6645),i=t(4567),n=t(6942),o=t.n(n),c=t(6540),d=t(7762),u=t(8983),m=t(4976),p=t(4972),h=t(4493),v=t(9785),b=t(1448),g=t(2199),x=t(5619),f=t(4848);
/* harmony import */const j=()=>{const e=(0,b/* .useDispatch */.wA)(),[a,t]=(0,c.useState)(null),[n,j]=(0,c.useState)(""),[y,w]=(0,c.useState)(""),[N,_]=(0,c.useState)(!1),[S,D]=(0,c.useState)(null),[A,k]=(0,c.useState)(!1),[E,T]=(0,c.useState)(0),C=(0,c.useRef)(!1);let q=!1;const L=(0/* .authSelectors */,b/* .useSelector */.d4)(u.Pg.getUser),{control:B,register:V,handleSubmit:F,getValues:I,setValue:M,formState:{errors:O},trigger:P,watch:H}=(0,v/* .useForm */.mN)(),{participant:Y,loading:$}=(0,p/* .useApiParticipant */.D)(S,q,E),{loading:U,sessions:R}=(0,h/* .useApiSpecificData */.Q)(),{logout:W,loading:z}=(0,x/* .useApiLogout */.M)();q="1"===Y?.participant?.is_online,(0,g/* .useBlockNavigation */.V)(A),(0,c.useEffect)((()=>{if(Y&&0!==R.length&&Y.contributions&&Array.isArray(Y.contributions)&&R.length>0){const e=Y.contributions.filter((e=>"talk"===e.type)).map((e=>({...e}))),a=Y.contributions.filter((e=>"poster"===e.type)).map((e=>({...e})));
// Set values in form so they persist on submit
M("talks",e),M("posters",a),
// Set wantsToContribute if at least one talk or poster exists
(e.length>0||a.length>0)&&M("wantsToContribute","1")}
// Handle Contributions (Talks & Posters)
}),[Y,R,M]),
// Detect form changes to prevent accidental navigation
// Detect form changes to prevent accidental navigation
(0,c.useEffect)((()=>{const e=H((()=>k(!0)));return()=>e.unsubscribe()}),[H]),
// Fetch user if missing
// Fetch user if missing
(0,c.useEffect)((()=>{L||e((0,u/* .fetchUser */.im)())}),[e,L]),
// Set participant ID once user is loaded
// Set participant ID once user is loaded
(0,c.useEffect)((()=>{L?.id&&D(L.id)}),[L]),
// Populate form with participant data when available
// Populate form with participant data when available
(0,c.useEffect)((()=>{if(!Y||0===R.length||C.current)return;C.current=!0,
// Set arrival details
Y.arrival&&Object.keys(Y.arrival).forEach((e=>{null!==Y.arrival[e]&&M(e,e.includes("hour")||e.includes("minute")?Y.arrival[e].toString().padStart(2,"0"):Y.arrival[e])}));
// Process contributions
const e=Y.contributions||[],a=e.filter((e=>"talk"===e.type)).map((e=>({...e||R[0]?.id}))),t=e.filter((e=>"poster"===e.type)).map((e=>({...e||R[0]?.id})));
// Store data in form fields
M("talks",a),M("posters",t)}),[Y,R,M]);
return(0/* ["default"] */,f.jsxs)(i.A,{title:"Update Your Data",children:[($||U)&&(0/* ["default"] */,f.jsx)(l.A,{text:"Fetching your recordâ€¦ Please wait."}),Y&&!$&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)("div",{className:"border rounded-2 p-3 mb-3",children:[(0,f.jsx)("p",{className:"fw-bolder",children:`Hello ${Y.participant.title} ${Y.participant.first_name} ${Y.participant.last_name},`}),(0,f.jsx)("p",{children:q?(0,f.jsxs)(f.Fragment,{children:["On this page, you have the option to update your contributions (talks). If you need to make any other changes to your records, please"," ",(0/* .Link */,f.jsx)(m.N_,{"aria-label":"Contact",to:"/contact",title:"Contact",children:"contact us"}),"."]}):(0,f.jsxs)(f.Fragment,{children:["On this page, you have the option to update either your travel details or contributions (talks & posters). If you need to make any other changes to your records, please"," ",(0/* .Link */,f.jsx)(m.N_,{"aria-label":"Contact",to:"/contact",title:"Contact",children:"contact us"}),"."]})}),!q&&(0,f.jsxs)("div",{className:"d-flex gap-2 mb-2",children:[(0,f.jsx)("button",{className:o()("btn fw-bolder","arrival"===a?"btn-primary":"btn-outline-primary"),onClick:()=>t("arrival"===a?null:"arrival"),children:"Travel Details"}),(0,f.jsx)("button",{className:o()("btn fw-bolder","contributions"===a?"btn-primary":"btn-outline-primary"),onClick:()=>t("contributions"===a?null:"contributions"),children:"Contributions"})]}),n&&(0,f.jsx)("div",{className:"alert alert-danger fw-bolder mt-3",children:n}),y&&(0,f.jsxs)("div",{className:"alert alert-success fw-bolder mt-3",children:[y,(0,f.jsx)("div",{className:"text-center mt-2",children:(0,f.jsx)("button",{"aria-label":"Logout",className:"btn btn-outline-danger px-3 fw-bolder ms-3",onClick:W,disabled:z,title:"Logout",children:z?"Logging out...":"Logout"})})]})]}),(!!a||q)&&(0,f.jsx)("div",{className:"mt-2 position-relative",children:(0,f.jsxs)("form",{onSubmit:F((async e=>{if(S){_(!0),k(!1),j(""),w("");try{const t="arrival"===a?"update_arrival":"update_contribution",r=await fetch(`https://imc2025.imo.net/php/api/${t}.php`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({participant_id:S,...e})}),s=await r.json();if(!s.success)throw new Error(s.message||"Failed to update data.");w("Your changes have been saved successfully! If you don't have other updates to make, please don't forget to "),T((e=>e+1))}catch(e){j("An error occurred while saving your data. Please, try again later or contact us.")}finally{_(!1)}}else alert("Error: Participant ID is missing. Please refresh the page and try again.")})),children:[N&&(0/* ["default"] */,f.jsx)(l.A,{isFixed:!1}),"arrival"===a&&(0/* ["default"] */,f.jsx)(r.A,{isEditing:!0,conferenceData:d/* .conferenceData */.p,register:V,errors:O,setValue:M,trigger:P}),("contributions"===a||q)&&(0/* ["default"] */,f.jsx)(s.A,{isEditing:!0,isOnline:q,conferenceData:d/* .conferenceData */.p,control:B,register:V,errors:O,getValues:I,setValue:M,watch:H,trigger:P,sessions:R}),(0,f.jsx)("div",{className:"mt-4 d-flex justify-content-end",children:(0,f.jsx)("button",{type:"submit",className:"btn btn-outline-primary fw-bolder",disabled:N,children:N?"Saving...":"Save Changes"})})]})})]})]})};
/* harmony default export */}
/***/,
/***/9156:
/***/(e,a,t)=>{
/* harmony export */t.d(a,{
/* harmony export */A:()=>u
/* harmony export */});
/* harmony import */var r=t(6942),s=t.n(r),l=t(8232),i=(t(6540),t(2834)),n=t(5846),o=t(4848);
/* harmony import */const c=Array.from({length:24},((e,a)=>a.toString().padStart(2,"0"))),d=Array.from({length:6},((e,a)=>(10*a).toString().padStart(2,"0"))),u=({isAdmin:e=!1,isEditing:a=!1,conferenceData:t,register:r,errors:u,isDebugMode:m=!1,step:p,stepTotal:h,trigger:v,setValue:b})=>{const g=(x=t.dates.start,f=t.dates.end,Array.from({length:(new Date(f)-new Date(x))/864e5+1},((e,a)=>{const t=new Date(x);return t.setDate(t.getDate()+a),{value:t.toISOString().split("T")[0],
// YYYY-MM-DD for MySQL
label:(0,n/* .formatFullDate */.Lu)(t.toISOString().split("T")[0],!1,!1)}})));
/**
   * Optional: Used for quick test filling.
   */var x,f;
return(0,o.jsxs)(o.Fragment,{children:[!e&&!a&&(0,o.jsxs)("h4",{className:"mb-3 border-bottom pb-2",children:[(0/* ["default"] */,o.jsx)(i.A,{step:p,stepTotal:h}),"Travel Details"]}),a&&(0,o.jsx)("h4",{className:"mb-3 border-bottom pb-2",children:"Update your Travel Details"}),(0,o.jsxs)("div",{className:s()(l/* ["default"] */.A.smallW,"mx-auto position-relative"),children:[m&&(0,o.jsx)("button",{type:"button",className:"position-absolute top-0 end-0 btn btn-secondary",onClick:()=>{b("arrival_date",g[0].value),b("arrival_hour","14"),b("arrival_minute","30"),b("departure_date",g[g.length-1].value),b("departure_hour","12"),b("departure_minute","00"),b("travelling","train"),b("travelling_details","I will be alone in my train."),v()}// Validate form
,children:"Fill Test Data"}),!e&&!a&&(0,o.jsxs)("p",{className:"fw-bolder",children:["If you plan to arrive before ",g[0].label,", you must arrange your own accommodation."]}),(0,o.jsxs)("div",{className:l/* ["default"] */.A.smallW,children:[(0,o.jsxs)("div",{className:"mb-3 row align-items-center",children:[(0,o.jsx)("label",{className:"col-sm-3 col-form-label fw-bold",children:"Arrival"}),(0,o.jsxs)("div",{className:"col-sm-9 d-flex align-items-center gap-1",children:[(0,o.jsxs)("select",{className:s()("form-select me-2",u.arrival_date&&"is-invalid"),...r("arrival_date",{required:"Arrival date is required"}),onBlur:()=>v("arrival_date"),children:[(0,o.jsx)("option",{value:"",children:"Select Arrival Date"}),g.map((({value:e,label:a})=>(0,o.jsx)("option",{value:e,children:a},e)))]}),(0,o.jsxs)("select",{className:s()("form-select w-auto",u.arrival_hour&&"is-invalid"),...r("arrival_hour",{required:"Hour is required"}),onBlur:()=>v("arrival_hour"),children:[(0,o.jsx)("option",{value:"",children:"Hour"}),c.map((e=>(0,o.jsx)("option",{value:e,children:e},e)))]}),":",(0,o.jsxs)("select",{className:s()("form-select w-auto",u.arrival_minute&&"is-invalid"),...r("arrival_minute",{required:"Minute is required"}),onBlur:()=>v("arrival_minute"),children:[(0,o.jsx)("option",{value:"",children:"Min"}),d.map((e=>(0,o.jsx)("option",{value:e,children:e},e)))]})]}),u.arrival_date&&(0,o.jsx)("p",{className:"text-danger mb-0",children:(0,o.jsx)("small",{children:u.arrival_date.message})})]}),(0,o.jsxs)("div",{className:"mb-3 row align-items-center",children:[(0,o.jsx)("label",{className:"col-sm-3 col-form-label fw-bold",children:"Departure"}),(0,o.jsxs)("div",{className:"col-sm-9 d-flex align-items-center gap-1",children:[(0,o.jsxs)("select",{className:s()("form-select me-2",u.departure_date&&"is-invalid"),...r("departure_date",{required:"Departure date is required"}),onBlur:()=>v("departure_date"),children:[(0,o.jsx)("option",{value:"",children:"Select Departure Date"}),g.map((({value:e,label:a})=>(0,o.jsx)("option",{value:e,children:a},e)))]}),(0,o.jsxs)("select",{className:s()("form-select w-auto",u.departure_hour&&"is-invalid"),...r("departure_hour",{required:"Hour is required"}),onBlur:()=>v("departure_hour"),children:[(0,o.jsx)("option",{value:"",children:"Hour"}),c.map((e=>(0,o.jsx)("option",{value:e,children:e},e)))]}),":",(0,o.jsxs)("select",{className:s()("form-select w-auto",u.departure_minute&&"is-invalid"),...r("departure_minute",{required:"Minute is required"}),onBlur:()=>v("departure_minute"),children:[(0,o.jsx)("option",{value:"",children:"Min"}),d.map((e=>(0,o.jsx)("option",{value:e,children:e},e)))]})]}),u.departure_date&&(0,o.jsx)("p",{className:"text-danger mb-0",children:(0,o.jsx)("small",{children:u.departure_date.message})})]}),(0,o.jsxs)("div",{className:"mb-3 row",children:[(0,o.jsx)("label",{className:"col-sm-3 col-form-label fw-bold",children:"Travelling by"}),(0,o.jsxs)("div",{className:"col-sm-9",children:[(0,o.jsxs)("select",{className:s()("form-select",u.travelling&&"is-invalid",l/* ["default"] */.A.mdAuto),...r("travelling",{required:"Mode of Transportation is required"}),onBlur:()=>v("travelling"),children:[(0,o.jsx)("option",{value:"",children:"Select a Mode of Transportation"}),(0,o.jsx)("option",{value:"car",children:"Car"}),(0,o.jsx)("option",{value:"bus",children:"Bus"}),(0,o.jsx)("option",{value:"plane",children:"Plane"}),(0,o.jsx)("option",{value:"train",children:"Train"}),(0,o.jsx)("option",{value:"local",children:"Local Resident"}),(0,o.jsx)("option",{value:"undecided",children:"Not yet decided"})]}),u.travelling&&(0,o.jsx)("p",{className:"text-danger mb-0",children:(0,o.jsx)("small",{children:u.travelling.message})})]})]}),(0,o.jsxs)("div",{className:"mb-3 row",children:[(0,o.jsx)("label",{className:"col-sm-3 col-form-label fw-bold",children:"Travel Details"}),(0,o.jsx)("div",{className:"col-sm-9",children:(0,o.jsx)("textarea",{className:"form-control",rows:"3",...r("travelling_details"),onBlur:()=>v("travelling_details")})})]})]})]})]})};
// Generate hour and minute options (both zero-padded strings)
}
/***/}]);