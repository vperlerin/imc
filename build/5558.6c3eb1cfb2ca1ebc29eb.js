"use strict";(self.webpackChunkimc2026=self.webpackChunkimc2026||[]).push([[5558],{
/***/490:
/***/(e,t,a)=>{a.r(t),
/* harmony export */a.d(t,{
/* harmony export */default:()=>$
/* harmony export */});
/* harmony import */var r=a(9066),s=a(1083),i=a(6540),n=a(9785),o=a(7767),l=a(5846),c=a(6538),d=a(9156),p=a(6827),m=a(8299),u=a(5680),h=a(5058),g=a(847),y=a(6645),f=a(4567),b=a(6505),x=a(2337),w=a(4668),j=a(3975),_=a(408),N=a(7762),D=a(4976),k=a(914),S=a(4157),A=a(4972),C=a(4493),M=a(7234),T=a(4848);
/* harmony import */const $=()=>{const e=(0,o/* .useLocation */.zy)(),t="1"===new URLSearchParams(e.search).get("debug"),[a,$]=(0,i.useState)({teamEmailSent:null,participantEmailSent:null,error:null}),[v,B]=(0,i.useState)(""),[I,V]=(0,i.useState)(!1),[E,F]=(0,i.useState)(null),[P,R]=(0,i.useState)(0),[O,H]=(0,i.useState)(""),[L,z]=(0,i.useState)(1),[W,Z]=(0,i.useState)(null),[q,G]=(0,i.useState)(0),{workshops:U,paymentMethods:Q,registrationTypes:Y,loading:J,sessions:K,error:X}=(0,C/* .useApiSpecificData */.Q)(),{participant:ee,loading:te,error:ae}=(0,A/* .useApiParticipant */.D)(E),re=J||te||I,se=[v,a.error,ae,X].filter(Boolean),{control:ie,register:ne,handleSubmit:oe,formState:{errors:le},getValues:ce,setValue:de,trigger:pe,watch:me}=(0,n/* .useForm */.mN)({defaultValues:{food_restrictions:[],food_restrictions_other:""}}),ue=(e=>{if(!e)return null;const t=new Date(e),a=new Date;let r=a.getFullYear()-t.getFullYear();const s=a.getMonth()-t.getMonth();return(s<0||0===s&&a.getDate()<t.getDate())&&r--,r})(me("dob")),he=null!==ue&&ue<16,ge=new Date<new Date(N/* .conferenceData */.p.deadlines.early_birds),ye=me("food_restrictions")??[],fe=Array.isArray(ye)&&ye.includes("other");
// When participant data arrives (admin/edit mode), map DB restrictions -> RHF fields
// When participant data arrives (admin/edit mode), map DB restrictions -> RHF fields
(0,i.useEffect)((()=>{
// Adjust these paths if your API returns a different shape
const e=ee?.food_restrictions||ee?.participant?.food_restrictions;if(!Array.isArray(e))return;const t=e.map((e=>e?.restriction)).filter(Boolean),a=e.find((e=>"other"===e?.restriction));de("food_restrictions",t,{shouldDirty:!1,shouldValidate:!1}),de("food_restrictions_other",a?.other_text??"",{shouldDirty:!1,shouldValidate:!1})}),[ee,de]);return(0,i.useEffect)((()=>{if(!ee||!O)return;(async()=>{try{const e=(await fetchSpecificData()).registration_types||[],t=e.filter((e=>"no"!==String(e?.type||"").toLowerCase())).filter((e=>Number(e?.total||0)>0)).filter((e=>Number(e?.room_left||0)<=0)),a="vperlerin@gmail.com".split(",").map((e=>({email:e,name:"BCC Recipient"})));if(t.length>0){const e=t.map((e=>{const t=String(e.type||"unknown"),a=Number(e.total||0);return`<li><strong>${t}</strong> (left: 0, used: ${Number(e.used||0)}, total: ${a})</li>`})).join(""),r=`${ee?.participant?.first_name||""} ${ee?.participant?.last_name||""}`.trim(),s=ee?.participant?.email||"",i=`\n          Hey IMC ${N/* .conferenceData */.p.year} Team,<br><br>\n          ⚠️ <strong>Room availability alert!</strong><br><br>\n          After the latest registration (${r}${s?` — ${s}`:""}),\n          the following room type${t.length>1?"s are":" is"} now <strong>SOLD OUT</strong>:<br><br>\n          <ul>\n            ${e}\n          </ul>\n          <br>\n        `;await(0,k/* .sendEmail */.Z)({subject:`⚠️ IMC ${N/* .conferenceData */.p.year} - Room type sold out`,message:i,to:"imc2026@imo.net",toName:"IMC 2026 Team",fromName:`IMC ${N/* .conferenceData */.p.year}`,replyTo:"no-reply@imc.net",replyName:"Do not reply",bcc:a})}const r=(0,M/* .registrationEmailToTeam */.Q)(ee,U,Q,e,K),s=(0,M/* .registrationEmailToParticipant */.K)(ee,U,Q,e,K,O),i=(ee.workshops?.filter((e=>"1"===e.attending))||[]).map((async e=>(0,k/* .sendEmail */.Z)({subject:"Workshop Registration",message:`Hey ${e.responsible_name.split(" ")[0]},<br><br>\n                    ${ee.participant.first_name} ${ee.participant.last_name} (${ee.participant.email})\n                    has just registered for the "${e.title}" (ON-SITE).<br>See you,<br>V./<br>`,to:e.responsible_email,toName:e.responsible_name,fromName:`IMC ${N/* .conferenceData */.p.year}`,replyTo:ee.participant.email,replyName:ee.participant.first_name+" "+ee.participant.last_name,bcc:a}))),n=await(0,k/* .sendEmail */.Z)({subject:"New On-site IMC Registration",message:r,to:"imc2026@imo.net",toName:"IMC 2026 Team",fromName:`IMC ${N/* .conferenceData */.p.year}`,replyTo:"no-reply@imc.net",replyName:"Do not reply",bcc:a}),o=await(0,k/* .sendEmail */.Z)({subject:"New On-site IMC Registration",message:s,to:ee.participant.email,toName:`${ee.participant.first_name} ${ee.participant.last_name}`,fromName:`IMC ${N/* .conferenceData */.p.year}`,replyTo:"no-reply@imc.net",replyName:"Do not reply",bcc:a});await Promise.all(i),$({teamEmailSent:n,participantEmailSent:o,error:null})}catch(e){$({teamEmailSent:null,participantEmailSent:null,error:e.message||"Failed to send emails"})}})()}),[ee,O,U,Q,K]),re?(0/* ["default"] */,T.jsx)(y.A,{}):(0/* ["default"] */,T.jsxs)(f.A,{title:"Register On site",showRegBtn:!1,children:[se.length>0&&(0,T.jsxs)("div",{className:"alert alert-danger fw-bolder",children:[(0,T.jsx)("ul",{className:"mb-0",children:se.map(((e,t)=>(0,T.jsx)("li",{children:e},t)))}),(0,T.jsxs)("div",{className:"mt-2",children:["If you think this is a mistake please try again or"," ",(0/* .Link */,T.jsx)(D.N_,{"aria-label":"Contact",to:"/contact",title:"Contact",children:"contact us"}),"."]})]}),8===L&&(0,T.jsx)(T.Fragment,{children:ee&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("h2",{children:N/* .conferenceData */.p.thank_you}),W&&!v&&(0,T.jsx)("div",{className:"alert alert-success fw-bolder",children:W}),(0,T.jsxs)("p",{className:"fw-bolder",children:["We just sent you an email with some instructions. This email contains a summary of your information as well as the password required to eventually update your travel details and your contributions (talks & posters). If you do not receive this email within the next 20 minutes"," ",(0/* .Link */,T.jsx)(D.N_,{"aria-label":"Contact",to:"/contact",title:"Contact",children:"contact us"})," ","immediately."]}),(0,T.jsxs)("div",{className:"d-flex flex-column flex-md-row gap-3",children:[(0,T.jsxs)("div",{className:"flex-grow-1",children:[(0,T.jsx)("p",{className:"fw-bolder text-danger",children:"The IMC fee is due without any delay."}),"paypal"===ee.participant.payment_method_name.toLowerCase?(0,T.jsxs)("div",{className:"mb-3",children:[(0,T.jsx)("p",{children:"Click the button below to pay immediately with Paypal."}),(0/* ["default"] */,T.jsx)(b.A,{amount:q+P,year:N/* .conferenceData */.p.year})]}):(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)("p",{children:(0,T.jsxs)("strong",{children:["Please, transfer the total amount of ",q,"€ to confirm your registration immediately."]})}),(0,T.jsxs)("blockquote",{className:"border rounded-2 p-3",children:["International Meteor Organization, Jozef Mattheessensstraat 60, 2540 Hove, Belgium",(0,T.jsx)("br",{}),"Bank account at BNP Paribas Fortis Bank Belgium",(0,T.jsx)("br",{}),"BIC bank code: GEBABEBB",(0,T.jsx)("br",{}),"IBAN account number: BE30 0014 7327 5911",(0,T.jsx)("br",{}),"e-mail: treasurer@imo.net"]})]})]}),(0/* ["default"] */,T.jsx)(x.A,{isOnline:!1,conferenceData:N/* .conferenceData */.p,participantData:ee,workshops:U,registrationTypes:Y,paymentMethods:Q})]})]})}),!ee&&!re&&(0,T.jsxs)("form",{onSubmit:oe((async e=>{V(!0),B(null),Z(null);try{const t="https://imc2026.imo.net/php/api/register_onsite.php",a={...e,
// make sure we always send predictable shapes
food_restrictions:Array.isArray(e.food_restrictions)?e.food_restrictions:[],food_restrictions_other:(e.food_restrictions_other??"").trim(),is_early_bird:ge.toString(),is_online:"false",talks:e.talks||[],posters:e.posters||[],total_due:q.toFixed(2),paypal_fee:P?.toFixed(2)||0},r=await s/* ["default"] */.A.post(t,a,{headers:{"Content-Type":"application/json"}});r.data.success?(Z(`Registration successful! (ID: ${r.data.participant_id}) `),F(r.data.participant_id),H(r.data.password)):(B(r.data.message||"Something went wrong."),Z("Registration successful but we couldn't send you an email"))}catch(e){B("Failed to submit the form. Please try again.")}finally{V(!1)}})),className:"d-flex flex-grow-1 flex-column position-relative",children:[I&&(0/* ["default"] */,T.jsx)(y.A,{}),(0,T.jsx)("input",{name:"is_early_bird",type:"hidden",value:ge,...ne("is_early_bird")}),(0,T.jsx)("input",{name:"is_online",type:"hidden",value:"false",...ne("is_online")}),1===L&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsxs)("p",{className:"border rounded-2 p-3",children:[(0,T.jsx)("b",{children:"People who need an invitation letter for Visa"})," must send their request without any delay to imc",N/* .conferenceData */.p.year,"@imo.net. Please, provide your legal private domicile or professional address, passport number and the address of the ",N/* .conferenceData */.p.consulate," where your visa application will be submitted."]}),new Date<new Date(N/* .conferenceData */.p.deadlines.early_birds)&&(0,T.jsxs)("p",{className:"d-flex border rounded-2 p-3 border-info text-info gap-2 mb-5",children:[(0/* .CiWarning */,T.jsx)(_.tP6,{className:r/* ["default"] */.A.warning}),(0,T.jsxs)("span",{children:[(0,T.jsxs)("span",{className:"d-block fw-bolder",children:["Hurry up! After ",(0/* .conferenceData */,l/* .formatFullDate */.Lu)(N.p.deadlines.early_birds),", a late booking fee of ",N/* .conferenceData */.p.costs.after_early_birds,"€ is added to the registration fee"]}),(0,T.jsx)("small",{children:"— because the early birds got the discount, and the latecomers just get the worms (and a fee :)."})]})]})]}),1===L&&(0/* ["default"] */,T.jsx)(g.A,{register:ne,errors:le,isDebugMode:t,step:L,stepTotal:8,setValue:de,trigger:pe}),2===L&&N/* .conferenceData */.p?.workshops?.length>0&&(0/* ["default"] */,T.jsx)(j.A,{conferenceData:N/* .conferenceData */.p,register:ne,errors:le,isDebugMode:t,step:L,stepTotal:8,setValue:de,trigger:pe,watch:me,workshops:U}),3===L&&(0/* ["default"] */,T.jsx)(d.A,{conferenceData:N/* .conferenceData */.p,register:ne,errors:le,isDebugMode:t,step:L,stepTotal:8,setValue:de,trigger:pe}),4===L&&(0/* ["default"] */,T.jsx)(u.A,{conferenceData:N/* .conferenceData */.p,control:ie,register:ne,isDebugMode:t,errors:le,step:L,stepTotal:8,getValues:ce,setValue:de,sessions:K,trigger:pe,watch:me}),5===L&&(0/* ["default"] */,T.jsx)(c.A,{conferenceData:N/* .conferenceData */.p,control:ie,register:ne,isDebugMode:t,isEarlyBird:ge,paymentMethods:Q,errors:le,registrationTypes:Y,step:L,stepTotal:8,setValue:de,trigger:pe}),6===L&&(0/* ["default"] */,T.jsx)(h.A,{conferenceData:N/* .conferenceData */.p,register:ne,errors:le,isDebugMode:t,step:L,stepTotal:8,setValue:de,trigger:pe,watch:me,control:ie}),7===L&&(0,T.jsxs)(T.Fragment,{children:[(0/* ["default"] */,T.jsx)(p.A,{register:ne,errors:le,isDebugMode:t,isUnder16:he,showGdpr:!0,step:L,stepTotal:8,setValue:de,trigger:pe}),(0/* ["default"] */,T.jsx)(m.A,{register:ne,errors:le,step:L,stepTotal:8,setValue:de,trigger:pe,watch:me})]}),8===L&&!W&&(0/* ["default"] */,T.jsx)(w.A,{isOnline:!1,getValues:ce,isEarlyBird:ge,conferenceData:N/* .conferenceData */.p,setTotal:G,setPaypalFee:R,showInfo:!W,workshops:U,registrationTypes:Y,paymentMethods:Q,watch:me}),(0,T.jsx)("div",{className:"mt-auto pt-3",children:(0,T.jsxs)("div",{className:"d-flex gap-3 justify-content-end",children:[L>1&&(0,T.jsxs)("button",{className:"btn btn-outline-primary fw-bolder d-inline-flex align-items-center gap-2",type:"button",onClick:()=>z(L-1),children:[(0/* .SlArrowLeft */,T.jsx)(S.SnO,{style:{strokeWidth:"110px"}})," Back"]}),L<8&&(0,T.jsxs)("button",{className:"btn btn-outline-primary fw-bolder d-inline-flex align-items-center gap-2",type:"button",onClick:async()=>{
// If we are on Extras step, make sure the "other" text validates
6===L&&fe&&await pe("food_restrictions_other");await pe()&&z(L+1)},children:["Continue ",(0/* .SlArrowRight */,T.jsx)(S.dH8,{style:{strokeWidth:"110px"}})]}),8===L&&(0,T.jsx)("button",{className:"btn btn-primary fw-bolder",type:"submit",children:"Submit"})]})})]})]})}}
/***/,
/***/9066:
/***/(e,t,a)=>{
/* harmony export */a.d(t,{
/* harmony export */A:()=>r
/* harmony export */});
// extracted by mini-css-extract-plugin
/* harmony default export */const r={root:"index-module__root--arE76","is-admin":"index-module__is-admin--SeEAz",warning:"index-module__warning--GHhh2"};
/***/}}]);