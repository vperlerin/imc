"use strict";(self.webpackChunkimc2025=self.webpackChunkimc2025||[]).push([[2029],{9963:(e,t,a)=>{a.r(t),a.d(t,{default:()=>S});var s=a(1083),i=a(6540),n=a(9785),r=a(7767),l=a(6328),o=a(6538),c=a(5680),p=a(476),m=a(6645),d=a(4567),u=a(6505),h=a(2337),g=a(4668),y=a(3975),b=a(7762),x=a(4976),f=a(914),j=a(4157),w=a(4972),N=a(4493),k=a(7234),_=a(4848);const S=()=>{const e=(0,r.zy)(),t="1"===new URLSearchParams(e.search).get("debug"),[a,S]=(0,i.useState)({teamEmailSent:null,participantEmailSent:null,error:null}),[C,B]=(0,i.useState)(""),[I,M]=(0,i.useState)(!1),[T,v]=(0,i.useState)(null),[D,A]=(0,i.useState)(0),[E,O]=(0,i.useState)(""),[R,P]=(0,i.useState)(1),[F,V]=(0,i.useState)(null),[$,L]=(0,i.useState)(0),{workshops:W,paymentMethods:z,registrationTypes:H,loading:Z,sessions:q,error:Q}=(0,N.Q)(),{participant:G,loading:J,error:K}=(0,w.D)(T);console.log("PARTICIPANT FROM DB ",G);const U=Z||J||I,X=[C,a.error,K,Q].filter(Boolean),{control:Y,register:ee,handleSubmit:te,formState:{errors:ae},getValues:se,setValue:ie,trigger:ne,watch:re}=(0,n.mN)(),le=new Date<new Date(b.p.deadlines.early_birds);return(0,i.useEffect)((()=>{if(!G||!E)return;(async()=>{try{const e=(0,k.Q1)(G,W,z,H,q),t=(0,k.KB)(G,W,z,H,q,E),a=G.workshops?.filter((e=>"1"===e.attending))||[],s="vperlerin@gmail.com".split(",").map((e=>({email:e,name:"BCC Recipient"}))),i=a.map((async e=>(0,f.Z)({subject:"Workshop Registration",message:`Hey ${e.responsible_name.split(" ")[0]},<br><br>\n                      ${G.participant.first_name} ${G.participant.last_name} (${G.participant.email})\n                      has just registered for the "${e.title}" (<b>ONLINE version</b>).<br>See you,<br>V./<br>`,to:e.responsible_email,toName:e.responsible_name,fromName:"IMC 2025",replyTo:G.participant.email,replyName:G.participant.first_name+" "+G.participant.last_name,bcc:s}))),n=await(0,f.Z)({subject:"New ONLINE IMC Registration",message:e,to:"vperlerin@gmail.com",toName:"IMC 2025 Team",fromName:"IMC 2025",replyTo:"no-reply@imc.net",replyName:"Do not reply",bcc:s}),r=await(0,f.Z)({subject:"New ONLINE IMC Registration",message:t,to:G.participant.email,toName:`${G.participant.first_name} ${G.participant.last_name}`,fromName:"IMC 2025",replyTo:"no-reply@imc.net",replyName:"Do not reply",bcc:s});await Promise.all(i),S({teamEmailSent:n,participantEmailSent:r,error:null})}catch(e){S({teamEmailSent:null,participantEmailSent:null,error:e.message||"Failed to send emails"})}})()}),[G,W,E]),U?(0,_.jsx)(m.A,{}):(0,_.jsxs)(d.A,{title:"Register Online",showRegBtn:!1,children:[X.length>0&&(0,_.jsxs)("div",{className:"alert alert-danger fw-bolder",children:[(0,_.jsx)("ul",{className:"mb-0",children:X.map(((e,t)=>(0,_.jsx)("li",{children:e},t)))}),(0,_.jsxs)("div",{className:"mt-2",children:["If you think this is a mistake please try again or "," "," ",(0,_.jsx)(x.N_,{"aria-label":"Contact",to:"/contact",title:"Contact",children:"contact us"}),"."]})]}),5===R&&(0,_.jsx)(_.Fragment,{children:G&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("h2",{children:b.p.thank_you}),F&&!C&&(0,_.jsx)("div",{className:"alert alert-success fw-bolder",children:F}),(0,_.jsxs)("p",{className:"fw-bolder",children:["We just sent you an email with some instructions. This email contains a summary of your information as well as the password required to eventually update your talks. If you do not receive this email within the next 20 minutes"," ",(0,_.jsx)(x.N_,{"aria-label":"Contact",to:"/contact",title:"Contact",children:"contact us"})," "," immediately."]}),(0,_.jsxs)("div",{className:"d-flex flex-column flex-md-row gap-3",children:[(0,_.jsxs)("div",{className:"flex-grow-1",children:[(0,_.jsx)("p",{className:"fw-bolder text-danger",children:"The IMC fee is due without any delay."}),"paypal"===(0,l.g)(G.participant.payment_method_id,z)?(0,_.jsxs)("div",{className:"mb-3",children:[(0,_.jsx)("p",{children:"Click the button below to pay immediately with Paypal."}),(0,_.jsx)(u.A,{amount:$+D,year:b.p.year})]}):(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)("p",{children:(0,_.jsxs)("strong",{children:["  Please, transfer the total amount of ",$,"â‚¬ to confirm your registration immediately."]})}),(0,_.jsxs)("blockquote",{className:"border rounded-2 p-3",children:["International Meteor Organization, Jozef Mattheessensstraat 60, 2540 Hove, Belgium",(0,_.jsx)("br",{}),"Bank account at BNP Paribas Fortis Bank Belgium",(0,_.jsx)("br",{}),"BIC bank code: GEBABEBB",(0,_.jsx)("br",{}),"IBAN account number: BE30 0014 7327 5911",(0,_.jsx)("br",{}),"e-mail: treasurer@imo.net"]})]})]}),(0,_.jsx)(h.A,{isOnline:!0,conferenceData:b.p,participantData:G,workshops:W,registrationTypes:H,paymentMethods:z})]})]})}),!G&&!U&&(0,_.jsxs)("form",{onSubmit:te((async e=>{M(!0),B(null),V(null);try{const t="https://imc2025.imo.net/php/api/register_online.php",a={...e,is_early_bird:le.toString(),is_online:"true",talks:e.talks||[],total_due:$,paypal_fee:D?.toFixed(2)||0},i=await s.A.post(t,a,{headers:{"Content-Type":"application/json"}});i.data.success?(V(`Registration successful! (ID: ${i.data.participant_id}) `),v(i.data.participant_id),O(i.data.password)):(B(i.data.message||"Something went wrong."),V("Registration successful but we couldn't send you an email"))}catch(e){B("Failed to submit the form. Please try again.")}finally{M(!1)}})),className:"d-flex flex-grow-1 flex-column position-relative",children:[I&&(0,_.jsx)(m.A,{}),(0,_.jsx)("input",{name:"is_online",type:"hidden",value:"false",...ee("is_online")}),1===R&&(0,_.jsx)(p.A,{register:ee,errors:ae,isOnline:!0,isDebugMode:t,step:R,stepTotal:5,setValue:ie,trigger:ne}),2===R&&(0,_.jsx)(c.A,{conferenceData:b.p,control:Y,register:ee,isDebugMode:t,isOnline:!0,errors:ae,step:R,stepTotal:5,getValues:se,setValue:ie,sessions:q,trigger:ne,watch:re}),3===R&&b.p?.workshops?.length>0&&(0,_.jsx)(y.A,{conferenceData:b.p,register:ee,errors:ae,isDebugMode:t,isOnline:!0,step:R,stepTotal:5,setValue:ie,trigger:ne,watch:re,workshops:W}),4===R&&(0,_.jsx)(o.A,{isOnline:!0,conferenceData:b.p,control:Y,register:ee,isDebugMode:t,isEarlyBird:le,paymentMethods:z,errors:ae,registrationTypes:H,step:R,stepTotal:5,setValue:ie,trigger:ne}),5===R&&!F&&(0,_.jsx)(g.A,{isOnline:!0,getValues:se,isEarlyBird:le,conferenceData:b.p,setTotal:L,setPaypalFee:A,showInfo:!F,workshops:W,registrationTypes:H,paymentMethods:z,watch:re}),(0,_.jsx)("div",{className:"mt-auto pt-3",children:(0,_.jsxs)("div",{className:"d-flex gap-3 justify-content-end",children:[R>1&&(0,_.jsxs)("button",{className:"btn btn-outline-primary fw-bolder d-inline-flex align-items-center gap-2",type:"button",onClick:()=>P(R-1),children:[(0,_.jsx)(j.SnO,{style:{strokeWidth:"110px"}})," Back"]}),R<5&&(0,_.jsxs)("button",{className:"btn btn-outline-primary fw-bolder d-inline-flex align-items-center gap-2",type:"button",onClick:async()=>{await ne()&&P(R+1)},children:["Continue ",(0,_.jsx)(j.dH8,{style:{strokeWidth:"110px"}})]}),5===R&&(0,_.jsx)("button",{className:"btn btn-primary fw-bolder",type:"submit",children:"Submit"})]})})]})]})}}}]);