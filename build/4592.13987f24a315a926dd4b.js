"use strict";(self.webpackChunkimc2025=self.webpackChunkimc2025||[]).push([[4592],{2199:(e,a,r)=>{r.d(a,{V:()=>s});var t=r(6540),l=r(7767);const s=e=>{const a=(0,l.Zp)(),r=(0,l.zy)();(0,t.useEffect)((()=>{const a=a=>{e&&(a.preventDefault(),a.returnValue="You have unsaved changes. Do you really want to leave?")};return window.addEventListener("beforeunload",a),()=>{window.removeEventListener("beforeunload",a)}}),[e]),(0,t.useEffect)((()=>{const t=t=>{if(e){window.confirm("You have unsaved changes. Do you really want to leave?")||(t.preventDefault(),a(r.pathname,{replace:!0}))}};return window.addEventListener("popstate",t),()=>{window.removeEventListener("popstate",t)}}),[e,a,r.pathname])}},8495:(e,a,r)=>{r.r(a),r.d(a,{default:()=>j});var t=r(9156),l=r(5680),s=r(6645),i=r(4567),n=r(6942),o=r.n(n),d=r(6540),c=r(7762),u=r(8983),m=r(4976),p=r(4972),h=r(4493),v=r(9785),b=r(1448),g=r(2199),x=r(5619),f=r(4848);const j=()=>{const e=(0,b.wA)(),[a,r]=(0,d.useState)(null),[n,j]=(0,d.useState)(""),[w,y]=(0,d.useState)(""),[N,_]=(0,d.useState)(!1),[D,S]=(0,d.useState)(null),[A,E]=(0,d.useState)(!1),[T,k]=(0,d.useState)(0),q=(0,d.useRef)(!1),C=(0,b.d4)(u.Pg.getUser),{control:L,register:B,handleSubmit:V,getValues:M,setValue:P,formState:{errors:I},reset:F,trigger:O,watch:H}=(0,v.mN)(),{participant:U,loading:Y}=(0,p.D)(D,T),{loading:$,sessions:R}=(0,h.Q)(),{logout:W,loading:z}=(0,x.M)();(0,g.V)(A),(0,d.useEffect)((()=>{const e=H((()=>E(!0)));return()=>e.unsubscribe()}),[H]),(0,d.useEffect)((()=>{C||e((0,u.im)())}),[e,C]),(0,d.useEffect)((()=>{C?.id&&S(C.id)}),[C]),(0,d.useEffect)((()=>{if(!U||0===R.length||q.current)return;q.current=!0,U.arrival&&Object.keys(U.arrival).forEach((e=>{null!==U.arrival[e]&&P(e,e.includes("hour")||e.includes("minute")?U.arrival[e].toString().padStart(2,"0"):U.arrival[e])}));const e=U.contributions||[],a=e.filter((e=>"talk"===e.type)).map((e=>({...e||R[0]?.id}))),r=e.filter((e=>"poster"===e.type)).map((e=>({...e||R[0]?.id})));P("talks",a),P("posters",r),console.log("UDPATED TALKS ",a)}),[U,R,P]);return(0,f.jsxs)(i.A,{title:"Update Your Data",children:[(Y||$)&&(0,f.jsx)(s.A,{text:"Fetching your recordâ€¦ Please wait."}),U&&!Y&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)("div",{className:"border rounded-2 p-3 mb-3",children:[(0,f.jsx)("p",{className:"fw-bolder",children:`Hello ${U.participant.title} ${U.participant.first_name} ${U.participant.last_name},`}),(0,f.jsxs)("p",{children:["On this page, you have the option to update either your travel details or contributions (talks & posters). If you need to make any other changes to your records, please"," ",(0,f.jsx)(m.N_,{"aria-label":"Contact",to:"/contact",title:"Contact",children:"contact us"}),"."]}),(0,f.jsxs)("div",{className:"d-flex gap-2 mb-2",children:[(0,f.jsx)("button",{className:o()("btn fw-bolder","arrival"===a?"btn-primary":"btn-outline-primary"),onClick:()=>r("arrival"===a?null:"arrival"),children:"Travel Details"}),(0,f.jsx)("button",{className:o()("btn fw-bolder","contributions"===a?"btn-primary":"btn-outline-primary"),onClick:()=>r("contributions"===a?null:"contributions"),children:"Contributions"})]}),n&&(0,f.jsx)("div",{className:"alert alert-danger fw-bolder mt-3",children:n}),w&&(0,f.jsxs)("div",{className:"alert alert-success fw-bolder mt-3",children:[w,(0,f.jsx)("button",{"aria-label":"Logout",className:"btn btn-outline-danger px-3 fw-bolder ms-3",onClick:W,disabled:z,title:"Logout",children:z?"Logging out...":"Logout"})]})]}),!!a&&(0,f.jsx)("div",{className:"mt-2 position-relative",children:(0,f.jsxs)("form",{onSubmit:V((async e=>{if(D){_(!0),E(!1),j(""),y("");try{const r="arrival"===a?"update_arrival":"update_contribution",t=await fetch(`https://imc2025.imo.net/php/api/${r}.php`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({participant_id:D,...e})}),l=await t.json();if(!l.success)throw new Error(l.message||"Failed to update data.");y("Your changes have been saved successfully! If you don't have other updates to make, please don't forget to "),k((e=>e+1))}catch(e){j("An error occurred while saving your data. Please, try again later or contact us.")}finally{_(!1)}}else alert("Error: Participant ID is missing. Please refresh the page and try again.")})),children:[N&&(0,f.jsx)(s.A,{isFixed:!1}),"arrival"===a&&(0,f.jsx)(t.A,{isEditing:!0,conferenceData:c.p,register:B,errors:I,setValue:P,trigger:O}),"contributions"===a&&(0,f.jsx)(l.A,{isEditing:!0,conferenceData:c.p,control:L,register:B,errors:I,getValues:M,setValue:P,watch:H,trigger:O,sessions:R}),(0,f.jsx)("div",{className:"mt-4 d-flex justify-content-end",children:(0,f.jsx)("button",{type:"submit",className:"btn btn-outline-primary fw-bolder",disabled:N,children:N?"Saving...":"Save Changes"})})]})})]})]})}},9156:(e,a,r)=>{r.d(a,{A:()=>u});var t=r(6942),l=r.n(t),s=r(8232),i=(r(6540),r(2834)),n=r(5846),o=r(4848);const d=Array.from({length:24},((e,a)=>a.toString().padStart(2,"0"))),c=Array.from({length:6},((e,a)=>(10*a).toString().padStart(2,"0"))),u=e=>{let{isAdmin:a=!1,isEditing:r=!1,conferenceData:t,register:u,errors:m,isDebugMode:p=!1,step:h,stepTotal:v,trigger:b,setValue:g}=e;const x=(f=t.dates.start,j=t.dates.end,Array.from({length:(new Date(j)-new Date(f))/864e5+1},((e,a)=>{const r=new Date(f);return r.setDate(r.getDate()+a),{value:r.toISOString().split("T")[0],label:(0,n.Lu)(r.toISOString().split("T")[0],!1,!1)}})));var f,j;return(0,o.jsxs)(o.Fragment,{children:[!a&&!r&&(0,o.jsxs)("h4",{className:"mb-3 border-bottom pb-2",children:[(0,o.jsx)(i.A,{step:h,stepTotal:v}),"Travel Details"]}),r&&(0,o.jsx)("h4",{className:"mb-3 border-bottom pb-2",children:"Update your Travel Details"}),(0,o.jsxs)("div",{className:l()(s.A.smallW,"mx-auto position-relative"),children:[p&&(0,o.jsx)("button",{type:"button",className:"position-absolute top-0 end-0 btn btn-secondary",onClick:()=>{g("arrival_date",x[0].value),g("arrival_hour","14"),g("arrival_minute","30"),g("departure_date",x[x.length-1].value),g("departure_hour","12"),g("departure_minute","00"),g("travelling","train"),g("travelling_details","I will be alone in my train."),b()},children:"Fill Test Data"}),!a&&!r&&(0,o.jsxs)("p",{className:"fw-bolder",children:["If you plan to arrive before ",x[0].label,", you must arrange your own accommodation."]}),(0,o.jsxs)("div",{className:s.A.smallW,children:[(0,o.jsxs)("div",{className:"mb-3 row align-items-center",children:[(0,o.jsx)("label",{className:"col-sm-3 col-form-label fw-bold",children:"Arrival"}),(0,o.jsxs)("div",{className:"col-sm-9 d-flex align-items-center gap-1",children:[(0,o.jsxs)("select",{className:l()("form-select me-2",m.arrival_date&&"is-invalid"),...u("arrival_date",{required:"Arrival date is required"}),onBlur:()=>b("arrival_date"),children:[(0,o.jsx)("option",{value:"",children:"Select Arrival Date"}),x.map((e=>{let{value:a,label:r}=e;return(0,o.jsx)("option",{value:a,children:r},a)}))]}),(0,o.jsxs)("select",{className:l()("form-select w-auto",m.arrival_hour&&"is-invalid"),...u("arrival_hour",{required:"Hour is required"}),onBlur:()=>b("arrival_hour"),children:[(0,o.jsx)("option",{value:"",children:"Hour"}),d.map((e=>(0,o.jsx)("option",{value:e,children:e},e)))]}),":",(0,o.jsxs)("select",{className:l()("form-select w-auto",m.arrival_minute&&"is-invalid"),...u("arrival_minute",{required:"Minute is required"}),onBlur:()=>b("arrival_minute"),children:[(0,o.jsx)("option",{value:"",children:"Min"}),c.map((e=>(0,o.jsx)("option",{value:e,children:e},e)))]})]}),m.arrival_date&&(0,o.jsx)("p",{className:"text-danger mb-0",children:(0,o.jsx)("small",{children:m.arrival_date.message})})]}),(0,o.jsxs)("div",{className:"mb-3 row align-items-center",children:[(0,o.jsx)("label",{className:"col-sm-3 col-form-label fw-bold",children:"Departure"}),(0,o.jsxs)("div",{className:"col-sm-9 d-flex align-items-center gap-1",children:[(0,o.jsxs)("select",{className:l()("form-select me-2",m.departure_date&&"is-invalid"),...u("departure_date",{required:"Departure date is required"}),onBlur:()=>b("departure_date"),children:[(0,o.jsx)("option",{value:"",children:"Select Departure Date"}),x.map((e=>{let{value:a,label:r}=e;return(0,o.jsx)("option",{value:a,children:r},a)}))]}),(0,o.jsxs)("select",{className:l()("form-select w-auto",m.departure_hour&&"is-invalid"),...u("departure_hour",{required:"Hour is required"}),onBlur:()=>b("departure_hour"),children:[(0,o.jsx)("option",{value:"",children:"Hour"}),d.map((e=>(0,o.jsx)("option",{value:e,children:e},e)))]}),":",(0,o.jsxs)("select",{className:l()("form-select w-auto",m.departure_minute&&"is-invalid"),...u("departure_minute",{required:"Minute is required"}),onBlur:()=>b("departure_minute"),children:[(0,o.jsx)("option",{value:"",children:"Min"}),c.map((e=>(0,o.jsx)("option",{value:e,children:e},e)))]})]}),m.departure_date&&(0,o.jsx)("p",{className:"text-danger mb-0",children:(0,o.jsx)("small",{children:m.departure_date.message})})]}),(0,o.jsxs)("div",{className:"mb-3 row",children:[(0,o.jsx)("label",{className:"col-sm-3 col-form-label fw-bold",children:"Travelling by"}),(0,o.jsxs)("div",{className:"col-sm-9",children:[(0,o.jsxs)("select",{className:l()("form-select",m.travelling&&"is-invalid",s.A.mdAuto),...u("travelling",{required:"Mode of Transportation is required"}),onBlur:()=>b("travelling"),children:[(0,o.jsx)("option",{value:"",children:"Select a Mode of Transportation"}),(0,o.jsx)("option",{value:"car",children:"Car"}),(0,o.jsx)("option",{value:"bus",children:"Bus"}),(0,o.jsx)("option",{value:"plane",children:"Plane"}),(0,o.jsx)("option",{value:"train",children:"Train"}),(0,o.jsx)("option",{value:"local",children:"Local Resident"}),(0,o.jsx)("option",{value:"undecided",children:"Not yet decided"})]}),m.travelling&&(0,o.jsx)("p",{className:"text-danger mb-0",children:(0,o.jsx)("small",{children:m.travelling.message})})]})]}),(0,o.jsxs)("div",{className:"mb-3 row",children:[(0,o.jsx)("label",{className:"col-sm-3 col-form-label fw-bold",children:"Travel Details"}),(0,o.jsx)("div",{className:"col-sm-9",children:(0,o.jsx)("textarea",{className:"form-control",rows:"3",...u("travelling_details"),onBlur:()=>b("travelling_details")})})]})]})]})]})}}}]);